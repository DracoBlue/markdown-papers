#!/usr/local/bin/node

var markdown_papers = require('./../lib/markdown-papers');
var fs = require("fs");
var util = require("util");
var file_name = process.argv[2];
var target_file_name = process.argv[3];

if (!file_name) {
    util.puts('No filename given.');
    util.puts('Correct usage: ' + process.argv[0] + ' ' + process.argv[1] + ' inputfile.md [outputfile.html]');
    process.exit(1);
}

var markdown_content = fs.readFileSync(file_name).toString();
markdown_papers.convertMarkdownToHtml(markdown_content, function(error, result_html) {
    /*
     * If second parameter is given, write it to file. Otherwise
     * output it.
     */
    if (target_file_name) {
        fs.writeFileSync(target_file_name, result_html, 'utf-8');
    } else {
        util.puts(result_html);
    }
});
